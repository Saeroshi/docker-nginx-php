#!/bin/sh

export PHP_POST_MAX_SIZE
export PHP_UPLOAD_MAX_FILESIZE
export PHP_MEMORY_LIMIT
export PHP_TIMEZONE
export PHP_DISPLAY_ERRORS
export PHP_DISPLAY_STARTUP_ERRORS

PHP_POST_MAX_SIZE=${PHP_POST_MAX_SIZE:-1024M}
PHP_UPLOAD_MAX_FILESIZE=${PHP_UPLOAD_MAX_FILESIZE:-1024M}
PHP_MEMORY_LIMIT=${PHP_MEMORY_LIMIT:-256M}
PHP_TIMEZONE=${PHP_TIMEZONE:-'Europe/Paris'}
PHP_DISPLAY_ERRORS=${PHP_DISPLAY_ERRORS:-Off}
PHP_DISPLAY_STARTUP_ERRORS=${PHP_DISPLAY_STARTUP_ERRORS:-Off}

sid -i -e "s|<PHP_POST_MAX_SIZE>|${PHP_POST_MAX_SIZE}|g" \
       -e "s|<PHP_UPLOAD_MAX_FILESIZE>|${PHP_UPLOAD_MAX_FILESIZE}|g" \
       -e "s|<PHP_MEMORY_LIMIT>|${PHP_MEMORY_LIMIT}|g" \
       -e "s|<PHP_TIMEZONE>|${PHP_TIMEZONE}|g" \
       -e "s|<PHP_DISPLAY_ERRORS>|${PHP_DISPLAY_ERRORS}|g" \
       -e "s|<PHP_DISPLAY_STARTUP_ERRORS>|${PHP_DISPLAY_STARTUP_ERRORS}|g" /php/etc/php-fpm.conf

exec php-fpm
